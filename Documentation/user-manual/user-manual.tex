\documentclass{article}

\usepackage{lipsum}
\usepackage[left=4cm, right=4cm, top=2cm, bottom=2cm, includefoot]{geometry}
\usepackage{graphicx}
\usepackage{float}
\usepackage{indentfirst}
\usepackage{listings}
\usepackage{hyperref}
\usepackage{color}

% Paragraph formatting
\usepackage{indentfirst}
\setlength{\parindent}{0em}
\setlength{\parskip}{1em}

% Header and footer
\usepackage{fancyhdr}
\pagestyle{fancy}

\rhead{}
\lhead{}
\fancyfoot{}
\fancyfoot[R]{\thepage}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
%

\begin{document}

\begin{titlepage}
	\begin{center}
		\line(1,0){400}\\
		[6mm]
		\huge{\bfseries User Manual}\\
		\line(1,0){400}\\
		[5mm]
		\includegraphics[width=150px]{../images/AWorldOfPlants.png}
		\\
		[5mm]
		\large\textbf{Project:}\\A World of Things\\
		[3mm]
		\large\textbf{Client:}\\Julian Hambleton-Jones\\
		[3mm]
		\large \textbf{Team:}\\Funge\\
		\line(1,0){400}\\
		[5mm]
		\large \textbf{Team Members:}\\
		[3mm]
		\large 14214742 - Matthew Botha\\
		\large 14446619 - Gian Paolo Buffo\\
		\large 14027021 - Matthias Harvey\\
        \large 14035538 - Dillon Heins\\[3mm]
	\end{center}
\end{titlepage}

\cleardoublepage
\thispagestyle{empty}
\input{../version_table.tex}
\cleardoublepage
\tableofcontents
\cleardoublepage
\setcounter{page}{1}

\textit{Disclaimer: The system is still under development. All documentation will be updated as the system progresses}

\section{System Overview}
	A World of Plants makes use of networked hardware devices to allow users to use the Internet to monitor and control the environment of living plants in real time.
	
	The system has been designed to make independent agriculture a fun and personalised experience. Compete to unlock new rewards or progress at your own leisure. Follow the plant suggestions to-the-letter or follow your own intuition. It's all up to you.
	
	Welcome to A World of Plants.

\section{System Configuration}
	A World of Plants is made up of 3 distinct parts:
	\begin{itemize}
		\item \textbf{Plant Box}, where your plants will live and grow. Your sensors will sit here as well.
		\item \textbf{The Cloud}, where all the behind-the-scenes magic takes place. Without this, there would be no data persistence, storage or communication.
		\item \textbf{Web app}, which you'll use to view plant info, interact with plants, and see how far you're progressing.
	\end{itemize}
	
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{../images/UserManual/plant-box.png}
		\caption{Plant Box}
	\end{figure}
	
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{../images/UserManual/the-cloud.png}
		\caption{The Cloud}
	\end{figure}
	
	The rest of the User Manual focuses on the Web app.
\section{Installation}
	\subsection{User Installation}
		The software can be found at \url{http://www.funge.cf}
		
		There is no installation necessary if you are an ordinary user, it is as simple as visiting the above listed website and registering.
		
		Registration can be done as follows:
		\begin{itemize}
			\item Visit \url{http://funge.cf}
			\item Select "Need an Account?"
			\item Enter the relevant details
			\item After selecting the "Sign Up" button you should be logged in automatically
		\end{itemize}
	
\cleardoublepage

	\subsection{Software Developer Installation}
		The software can be found at \url{https://github.com/DillonHeins/Funge}
		\subsubsection{Initial Set Up}
			\begin{itemize}
				\item Set up an AWS account by visiting:
					\begin{itemize}
						\item \url{https://aws.amazon.com/}
					\end{itemize}
				\item Download and install the AWS command line interface:
					\begin{itemize}
						\item Additional information can be located at \url{https://aws.amazon.com/cli/}
					\end{itemize}
				\item Install Java Development Kit 8:
					\begin{itemize}
						\item \url{http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html}
					\end{itemize}
				\item Install Apache Maven. Instructions on how to download, install and run Maven can be located at:
					\begin{itemize}
						\item \url{https://maven.apache.org/}
					\end{itemize}
			\end{itemize}
		\subsubsection{Java Backend Installation}
			\begin{itemize}
				\item Navigate to BackEnd/a-world-of-plants
				\item Open a command line window on your operating system of choice
				\item Run the command:
				\begin{itemize}
					\item 
\begin{lstlisting}
mvn test package
\end{lstlisting}
					\item This command will first test the code to ensure it is running accordingly and it will then package the software into a .jar file
				\end{itemize}
				\item Navigate to BackEnd/a-world-of-plants/target
				\item In order to upload the .jar to AWS S3 and deploy it to AWS Lambda run the following commands:
					\begin{itemize}
						\item 
\begin{lstlisting}
aws s3 cp jarname.jar s3://bucket-name
\end{lstlisting}

						\item
\begin{lstlisting}
aws lambda update-function-code --function-name function 
\--s3-bucket bucket-name --s3-key jarname.jar
\end{lstlisting}
					\end{itemize}	
			\end{itemize}

\cleardoublepage		

		\subsubsection{AngularJS Frontend Installation}
			Navigate to FrontEnd/AWorldOfPlantsApp
			\begin{itemize}
				\item To run the AngularJS App locally:
					\begin{itemize}
						\item Open a command line interface on your operating system of choice
						\item Run the command:
							\begin{itemize}
								\item 
\begin{lstlisting}
npm install
\end{lstlisting}
							\end{itemize}
						\item Navigate to http://localhost:8000 in your browser
					\end{itemize}
				\item To deploy the AngularJS App to S3 run the command:
					\begin{itemize}
						\item
\begin{lstlisting}
aws s3 cp app s3://website.com --recursive --exclude "*.log"
\end{lstlisting}
					\end{itemize}
			\end{itemize}		

\section{Getting Started}
	\subsection{Landing Page}
	\subsubsection{Logging in}
		\textcolor{red}{(1)} The first page you'll encounter is the login page. If you already have an account, enter your username and password in the appropriate blocks and click "Sign In".
		\newline
		\textcolor{red}{(2)} If you'd like to find out more about A World of Plants, you can scroll down to our information page. Scroll back up when you're ready to login or register.
		\newline
		\textcolor{red}{(3)} If you have not yet registered, click on "Need an account?" to navigate to the account registration.
		\begin{figure}[H]
			\includegraphics[width=\textwidth]{../images/UserManual/login.PNG}
			\caption{Login Page}
		\end{figure}				
		
	\subsubsection{Account Registration}
		\textcolor{red}{(1)} If you do not yet have an account, enter your email, the username you'd like to be known by, and your password (twice) and click the "Sign Up" button.
		\newline
		\textcolor{red}{(2)} If you already have an account and would like to log in, click on "Have an Account?" to navigate to the user login.
		\newline
		\begin{figure}[H]
			\includegraphics[width=\textwidth]{../images/UserManual/registration.PNG}
			\caption{Registration Page}
		\end{figure}
		
\subsection{Main Site}
	\subsubsection{Navbar}
	All pages on the main site will display the navbar at the top as well as along the left side.
		\paragraph{User Actions}
		\textcolor{red}{(1)} To access your user actions, click on your username at the right of the navbar. From here, you can either navigate to your profile or log out.
		\begin{figure}[H]
			\includegraphics[width=\textwidth]{../images/UserManual/navbar-user-actions.PNG}
			\caption{Navbar User Actions}
		\end{figure}

\cleardoublepage

\section{Using the System}
	All the top level items under this section can be directly or indirectly accessed via the left-sided navigation bar.
	
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{../images/UserManual/side-navbar.png}
		\caption{Side Navbar}
	\end{figure}	
	
	\subsection{Dashboard}
	The Dashboard provides a quick summary of your activities through a timeline, as well as info about your plants, Plant Boxes and score.
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{../images/UserManual/timeline.png}
		\caption{User Timeline}
	\end{figure}

	\subsection{Plants}
	To access your plants, click on "Plants" in the sidebar. This page will display a summary of all your current plants.
	\newline
	\textcolor{red}{(1)} To add a new plant, click on the "Create New Plant" button on the top right. See \hyperref[sec:creating-a-plant]{Creating a Plant} for more information.
	\newline
	\textcolor{red}{(2)} To view more information or change some of the details for a specific plant, click on "View Details" for the plant of your choice. See \hyperref[sec:plant-details]{Plant Details} for more information.
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{../images/UserManual/plants.PNG}
		\caption{Plants View}
	\end{figure}
		
		\subsubsection{Creating a Plant}
		\label{sec:creating-a-plant}
		To create a plant, enter the plant's unique details and then click on ``Create''.
		\begin{figure}[H]
			\includegraphics[width=\textwidth]{../images/UserManual/create-plant.PNG}
			\caption{Creating a Plant}
		\end{figure}
		
	\subsection{Plant Details}
	\label{sec:plant-details}
	From here you can get an overview of all of your plant's details.
	\newline
	\textcolor{red}{(1)} To update plant details such as the plant's name or category, make your desired changes and then click the "Update" button.
	\newline
	\textcolor{red}{(2)} If you'd like to delete your plant, click on the red "Delete" button. \textbf{This is permanent}, so be careful.
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{../images/UserManual/plant-details.PNG}
		\caption{Plant Details}
	\end{figure}
	
	From the Plant Details, you can also view realtime graphs of the currently selected plant's temperature and humidity, as well as directly change the colour and intensity of your Plant Box's lights.
	
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{../images/UserManual/lights.png}
		\caption{Lights Control}
	\end{figure}	
	
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{../images/UserManual/temperature.png}
		\caption{Temperature Graph}
	\end{figure}
	
\cleardoublepage

	\subsection{Plant Boxes}
	To access your Plant Boxes, click on ``Plant Boxes'' in the sidebar. This page will display all existing Plant Boxes.
	\newline
	\textcolor{red}{(1)} To add a new Plant Box, click on the ``Create New Plant Box'' button on the top right. See \hyperref[sec:creating-a-plant-box]{Creating a Plant Box} for more information.
	\newline
	\textcolor{red}{(2)} To update which plant your Plant Box is linked to, choose an existing plant from the dropdown menu and then click the ``Update'' button.
	\newline
	\textcolor{red}{(3)} If you'd like to delete an existing Plant Box, click on the red ``Delete'' button. \textbf{This is permanent}, so be careful.  
	\newline
	\textcolor{red}{(4)} If you need help with setting up your Plant Box, click on the ``Help me'' button.	
	
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{../images/UserManual/plant-boxes.png}
		\caption{Plant Boxes View}
	\end{figure}	
	
	\subsubsection{Creating a Plant Box}
	\label{sec:creating-a-plant-box}
	To create a Plant Box, enter the box's unique name, associate it with an existing plant, choose a colour to make it stand out, and then click on ``Create''.
	\begin{figure}[H]
		\includegraphics[width=\textwidth]{../images/UserManual/create-plant-box.png}
		\caption{Creating a Plant Box}
	\end{figure}
	
\section{Troubleshooting}

\subsection{Web-interface Troubleshooting}
	The system has been designed to return varying HTTP status codes depending on whether an operation was successful or not. If a user would like to see more detail with regard to these codes they may open the developer console on their preferred browser. However, the system automatically responds to these codes and handles them accordingly.\\
	
	The details of these HTTP status codes are listed below:
	\begin{itemize}
		\item 200 - Success
			\begin{itemize}
				\item This is the code returned when all operations are functioning as expected
				\item The system should continue without any problems or user intervention
			\end{itemize}
		\item 400 - Client Error
			\begin{itemize}
				\item This code is associated with bad requests
				\item A bad request occurs whenever a request fails validation, i.e. when a client formats the request in a manner that the system was not expecting
				\item This could occur when the user enters incorrect details or when a page is requested that does not exist
			\end{itemize}
			\begin{figure}[H]
				\includegraphics[width=\textwidth]{../images/UserManual/400error.png}
				\caption{Incorrect User Details Error}
			\end{figure}
			
\cleardoublepage

		\item 500 - Server Error
			\begin{itemize}
				\item This occurs when an internal error occurs on the server. The server will attempt to resolve this issue without user intervention as best as possible
				\item The user may be notified if the error affects them
				\item Some examples of this error would be:
				\begin{itemize}
					\item Inability to create a new user in the database
					\item Inability to create a new plant or plant box in the database
					\item Not all the necessary details have been supplied for the creation of a user/plant/plant box
					\item There is a network error with regard to connecting to the plant box (Note: future functionality will ensure the client continues to retry to connect to the plant box without user intervention)
				\end{itemize}
				\item The interface has been designed to ensure all input is validated before being sent through so as to minimise the possibility of these errors occurring
			\end{itemize}
			\begin{figure}[H]
				\includegraphics[width=\textwidth]{../images/UserManual/500error.png}
				\caption{Error Establishing Connection to Plant Box}
			\end{figure}
	\end{itemize}

	In conclusion the user will be notified of any errors which they may need to address with detailed descriptions via the interface when the system is unable to handle them itself.
	
\cleardoublepage	
	
	\subsection{Plant Box Troubleshooting}
		\subsubsection{Problem: Device cannot connect to AWS IoT platform}
			\paragraph{Device may not have been set up correctly:} 
				Ensure your \colorbox{cyan}{\lstinline[basicstyle=\ttfamily\color{white}]|aws_iot_config.h|} file has been set up with the correct details in terms of the AWS IoT MQTT host, port, etc.
			\paragraph{Device does not have the correct certificates and/or keys:}
				Download the corresponding files associated with your Plant Box via the user interface and ensure they are present on your Plant Box's hardware device
				
		\subsubsection{Problem: Published messages are not being received}
			\paragraph{Message formatting may be incorrect:}
				Ensure that the messages being passed from the Plant Box to the MQTT client obey the following format:
\begin{lstlisting}
{
  "state": {
    "desired": {
    	"key1": "value1",
    	"key2": "value2"
    },
    "reported": {
      "key1": "value1",
      "key2": "value2"
    }
  }
}
\end{lstlisting}
			\paragraph{Plant Box may be disconnected:} Ensure you see the message "Successfully connected to MQTT client" on a Plant's Details page
			\paragraph{Plant Box may not be powered on:} Ensure the Plant Box's hardware device is plugged in and receiving power

\end{document}
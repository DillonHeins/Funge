\documentclass{article}

\usepackage[margin=4cm, includefoot]{geometry}
\usepackage{graphicx}
\usepackage{float}
\usepackage[hidelinks]{hyperref}

% Paragraph formatting
\usepackage{indentfirst}
\setlength{\parindent}{0em}
\setlength{\parskip}{1em}

% Header and footer
\usepackage{fancyhdr}
\pagestyle{fancy}
\setcounter{secnumdepth}{4}

\rhead{}
\lhead{}
\fancyfoot{}
\fancyfoot[R]{\thepage}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
%enewcommand{\footrulewidth}{0pt}
%

\begin{document}

\begin{titlepage}
	\begin{center}
		\line(1,0){500}\\
		[6mm]
		\huge{\bfseries Testing Document}\\
		\line(1,0){500}\\
		[5mm]
		\includegraphics[width=150px]{../images/AWorldOfPlants.png}
		\\
		[5mm]
		\large\textbf{Project:}\\A World of Things\\
		[3mm]
		\large\textbf{Client:}\\Julian Hambleton-Jones\\
		[3mm]
		\large \textbf{Team:}\\Funge\\
		\line(1,0){500}\\
		[5mm]
		\large \textbf{Team Members:}\\
		[3mm]
		\large 14214742 - Matthew Botha\\
		\large 14446619 - Gian Paolo Buffo\\
		\large 14027021 - Matthias Harvey\\
        \large 14035538 - Dillon Heins\\[3mm]
	\end{center}
\end{titlepage}

\cleardoublepage
\thispagestyle{empty}
\tableofcontents
\input{../version_table}
\cleardoublepage
\setcounter{page}{1}

\textit{Disclaimer: The system is still under development. All documentation will be updated as the system progresses}

\section{Introduction}
	The Internet of Things (IoT) is a development of the Internet which involves the networking of every day physical devices allowing them to send and receive data. These devices are embedded with electronics, sensors, software as well as some form of Internet or network connectivity.
	
	IoT is a relatively new development and has a large possibility of becoming a ubiquitous technology as well as allowing us to view the world from a different perspective. The potential it contains for innovation is endless.
	
	We as a group were given the opportunity to use the Amazon Web Services (AWS) IoT platform to create an IoT project of our own desires. This document details our 'A World of Things' project.
	
	A remote, real-time plant monitoring and environment control system is implemented using a cloud based, micro-services, Platform as a Service (PaaS) architecture, with the front-end interface using the Model-View-Controller (MVC) model.
	
	In order to ensure that our system runs as expected and meets all of the functional and non-functional requirements, it is important to fully test the system. A testing plan has therefore been drawn up and implemented.
	
	\subsection{Purpose}
		This document lays out the testing plan for our system (technologies used, unit tests etc.) as well as the testing report, detailing the results and artefacts produced by the implementation of this plan.
		
	\subsection{Scope}
		This document contains two main sections, the testing plan (Sections 2 to 4) and the Unit Test Report (Section 5).
		
		Inside the testing plan, the testing items have been identified (Section 2). The functional features (2.1) are the functional use cases from the system and have been taken from the Architectural and Functional Requirements Design Specification document, where they are explained in greater detail.
		
		Section 2.2 explains the non-functional features that will be tested. \textit{This will be added to and expanded on later.}
		
		Section 3 goes into greater detail about each of the use cases, listing the pre- and post-conditions of each test, and the different conditions that will be tested, including the objective, input and expected outcome of each condition.
		
		The test deliverables are outlined in section 4.
		
		The Unit Test Report (Section 5) includes the following:
		\begin{itemize}
			\item A detailed overview (5.1) of each of each of the tests, naming which tests passed and which failed, along with the reasons for the results achieved.
			\item Other artefacts generated from the testing plan (5.2)
			\item A final conclusion and some recommendation (5.3) for further testing.
		\end{itemize}
		
		\textit{At a later stage, this document will also include the usability report.}
		
	\subsection{Test Environment}
	
		The properties of the testing environment are as follows:
		\begin{itemize}
			\item Programming Languages:
				\begin{itemize}
					\item Java
					\item NodeJS
					\item AngularJS
					\item JavaScript
					\item HTML5
				\end{itemize}
			\item Testing Frameworks:
				\begin{itemize}
					\item JUnit
					\item Mockito
					\item Maven
					\item Spring (dependency injection)
					\item Travis (integration)
					\item Karma
					\item Protractor
				\end{itemize}
			\item Coding Environments:
				\begin{itemize}
					\item IntelliJ IDEA
					\item AWS Lambda Inline Console
					\item Arduino IDE
				\end{itemize}
			\item Operating System:
				\begin{itemize}
					\item Java Virtual Machine (JVM)
					\item OS not known
				\end{itemize}
			\item Internet Browsers:
				\begin{itemize}
					\item Internet Explorer
					\item Firefox
					\item Chrome
					\item Opera
					\item Safari
				\end{itemize}
		\end{itemize}
	
	\subsection{Assumptions and Dependencies}
		During testing, it is assumed that:
		\begin{itemize}
			\item A reliable internet connection is established and used
			\item The AWS services are up and running
			\item The device used for testing is configured and connected to the internet
		\end{itemize}
		
		The testing requires the following dependencies:
		\begin{itemize}
			\item AWS SDK
		\end{itemize}

\newpage

\section{Test Items}
	In order to fully test our system, the testing plan needs to detail the different sections of the system that need to be tested. There are two different kinds of items that need to be tested: functional and non-functional features of the system.
	
	\subsection{Functional Features to be Tested}
		The following test items are the functional use cases of the system and have been taken from the Architectural and Functional Requirements Design Specification document, where they are explained in greater detail. The functional features fall into four subsystems, namely database management, user management, plant/device management and device communications.
		
		\begin{itemize}
			\item Database Management
				 \begin{itemize}
				 	\item Persist to Database
				 	\item Query Database
				 	\item Remove from Database
				 \end{itemize}
			\item User Management Subsystem
				\begin{itemize}
					\item Register User
					\item Login
					\item Create User Session
					\item Logout
					\item Terminate Session
					\item Update User
				\end{itemize}
			\item Plant/Device Management Subsystem
				\begin{itemize}
					\item Create Plant
					\item Delete Plant
					\item List Plants
					\item View Plant
					\item Subscribe to Topic
					\item Update Plant
					\item Create Thing
					\item Configure Lights
					\item Configure Pump
					\item Configure Fan
				\end{itemize}
			\item Device Communications Subsystem
				\begin{itemize}
					\item Update Thing Shadow
					\item Update Web Interface
				\end{itemize}
		\end{itemize}
	\subsection{Non-Functional Features to be Tested} 
		\textit{This section has not been fully planned yet and will be completed in later versions of this document}
		\begin{itemize}
			\item Usability
		\end{itemize}
		
\section{Test Cases}
	This section of the testing plan will detail each of the tests that will be performed, naming their pre- and post-conditions, the different conditions to be tested, and the objective, input and expected outcome of each of those conditions. The items are grouped into the different subsystems that they fall under.
	
	\subsection{Database Management}
		\subsubsection{Persist to Database}
			\textbf{Pre-conditions:}
			\begin{itemize}
				\item DynamoDB is running
				\item The correct table(s) have been created
			\end{itemize}
			\textbf{Post-conditions:}
			\begin{itemize}
				\item A new entry has been entered into the correct table in the database
			\end{itemize}
			
			\paragraph{Condition: Correct Key Fields and Unique Keys}
				\subparagraph{Objective}
					To test if data is persisted to the database if the correct key fields have been filled in (minimum requirements for an insertion) and a unique key pair is given.
				
				\subparagraph{Input}
					\begin{itemize}
						\item Table Name: "testTable"
						\item Key1 Value: "uniqueKey1"
						\item Key2 Value: "uniqueKey2"
					\end{itemize}
				
				\subparagraph{Outcome}
					A new record is created in the "testTable" table with the correct keys.
			
			\paragraph{Condition: Correct Key Fields but Non-Unique Keys}	
				\subparagraph{Objective}
					To test if data is persisted to the database if the correct key fields have been filled in (minimum requirements for an insertion) but a non-unique key pair is given.
					
				\subparagraph{Input}
					\begin{itemize}
						\item Table Name: "testTable"
						\item Key1 Value: "nonUniqueKey1"
						\item Key2 Value: "nonUniqueKey2"
					\end{itemize}
					
				\subparagraph{Outcome}
					No new record is created in the "testTable".
				
			\paragraph{Condition: Not All Key Fields Given}
				\subparagraph{Objective}
					To test if data is persisted to the database if the correct key fields have not been filled in (minimum requirements for an insertion).
					
				\subparagraph{Input}
				\begin{itemize}
					\item Table Name: "testTable"
					\item Key1 Value: "uniqueKey1"
					\item Key2 Value: none
				\end{itemize}
				
				\subparagraph{Outcome}
					No new record is created in the "testTable" table.
			
		\subsubsection{Query Database}
			\textbf{Pre-conditions:}
			\begin{itemize}
				\item DynamoDB is running
				\item The correct table(s) have been created
				\item There is a record created in the table
			\end{itemize}
			\textbf{Post-conditions:}
			\begin{itemize}
				\item One or more records is retrieved from the database
			\end{itemize}
			
			\paragraph{Condition: Authorised Role}
				\subparagraph{Objective}
					To test if data can be retrieved from the database via a query using the correct permission role
				
				\subparagraph{Input}
					\begin{itemize}
						\item Table Name: "testTable"
						\item Key1 Value: "key1"
						\item Key2 Value: "key2"
						\item Role: "databaseQueryRole"
					\end{itemize}
			
				\subparagraph{Outcome}
					A record with the same key values as the input is retrieved from the database.
			
			\paragraph{Condition: Unauthorised Role}
				\subparagraph{Objective}
					To test if data can be retrieved from the database via a query using an incorrect permission role
				
				\subparagraph{Input}
					\begin{itemize}
						\item Table Name: "testTable"
						\item Key1 Value: "key1"
						\item Key2 Value: "key2"
						\item Role: "generalRole"
					\end{itemize}
				
				\subparagraph{Outcome}
					No record is retrieved from the database.
		
		\subsubsection{Remove from Database}
			\textbf{Pre-conditions:}
			\begin{itemize}
				\item DynamoDB is running
				\item The correct table(s) have been created
				\item There is a record created in the table
			\end{itemize}
			\textbf{Post-conditions:}
			\begin{itemize}
				\item A record is removed from the database
			\end{itemize}
			
			\paragraph{Condition: Authorised Role}
				\subparagraph{Objective}
					To test if data can be deleted from the database via a query using the correct permission role
				
				\subparagraph{Input}
				\begin{itemize}
					\item Table Name: "testTable"
					\item Key1 Value: "key1"
					\item Key2 Value: "key2"
					\item Role: "databaseDeleteRole"
				\end{itemize}
				
				\subparagraph{Outcome}
					A record with the same key values as the input is deleted from the database.
				
				\paragraph{Condition: Unauthorised Role}
				\subparagraph{Objective}
					To test if data can be deleted from the database via a query using an incorrect permission role
				
				\subparagraph{Input}
				\begin{itemize}
					\item Table Name: "testTable"
					\item Key1 Value: "key1"
					\item Key2 Value: "key2"
					\item Role: "generalRole"
				\end{itemize}
				
				\subparagraph{Outcome}
				No record is deleted from the database
	
	\subsection{User Management}
		\subsubsection{Register User}
			\textbf{Pre-conditions:}
			\begin{itemize}
				\item AWS is up and running
			\end{itemize}
			\textbf{Post-conditions:}
			\begin{itemize}
				\item A new user is registered and logged in to the system
			\end{itemize}
			
			\paragraph{Condition: Unique User Name Email Provided}
				\subparagraph{Objective}
					To test if a new user can be registered using a unique user name email address.
					
				\subparagraph{Input}
				\begin{itemize}
					\item Email Address: "unique@email.com"
					\item User Name: "UniqueUser"
					\item Password: "pass123"
				\end{itemize}
				
				\subparagraph{Outcome}
					A new user is created and logged into the system.
					
			\paragraph{Condition: User Name or Email Taken}
				\subparagraph{Objective}
					To test if a new user can be registered using a unique user name email address.
				
				\subparagraph{Input}
					\begin{itemize}
						\item Email Address: "unique@email.com"
						\item User Name: "UniqueUser"
						\item Password: "pass123"
					\end{itemize}
				
				\subparagraph{Outcome}
					A new user is created and logged into the system.
		
		\subsubsection{Login}
			\textbf{Pre-conditions:}
				\begin{itemize}
					\item Username must not be null
					\item Password must not be null
					\item User account associated with username must exist
					\item The password after being hashed and salted must match that of the provided username
				\end{itemize}
			\textbf{Post-conditions:}
				\begin{itemize}
					\item The user should be given temporary user credentials in a response object
					\item The user should be given access to their information and redirected to their dashboard
				\end{itemize}
			
			\paragraph{Condition: Correct Login Details}
				\subparagraph{Objective}
					To test if the user can log in with correct log in details (user name and password).
					
				\subparagraph{Input}
					\begin{itemize}
						\item User Name: "User1"
						\item Password: "correctPass"
					\end{itemize}
			
				\subparagraph{Outcome}
					A user is logged in an a session is created.
			
			\paragraph{Condition: Incorrect Login Details}
				\subparagraph{Objective}
					To test if the user can log in with incorrect log in details (user name and password).
				
				\subparagraph{Input}
					\begin{itemize}
						\item User Name: "User1"
						\item Password: "incorrectPass"
					\end{itemize}
				
				\subparagraph{Outcome}
					No user is logged in.
					
		\subsubsection{Logout}		
			\textbf{Pre-conditions:}
				\begin{itemize}
					\item A user must be registered on the system
					\item The user must be logged into the system
				\end{itemize}
			\textbf{Post-conditions:}
				\begin{itemize}
					\item The user should be no longer logged into the system and as such not be able to access any functionality from the system except to register an account or log in
					\item If the user wishes to access their account and the functionality of the system, they should have to log back into the system
				\end{itemize}
			
			\paragraph{Condition: User is logged in}
				\subparagraph{Objective}
					To test if the user is logged out (session authorisation removed).
					
				\subparagraph{Input}
					\begin{itemize}
						\item User Session
					\end{itemize}
				
				\subparagraph{Outcome}
					The user session is terminated and the user cannot access any page except for the Login and Register pages.
					
		\subsubsection{Update User}
			\textbf{Pre-conditions:}
				\begin{itemize}
					\item User must be logged in
					\item User editing details should be the owner of those details
				\end{itemize}
			\textbf{Post-conditions:}
				\begin{itemize}
					\item The values of the edited details should be reflected in the database
				\end{itemize}
		
			\paragraph{Condition: User is logged in}
				\subparagraph{Objective}
					To test if the user details can be edited by the user if the user is logged in.
					
				\subparagraph{Input}
					\begin{itemize}
						\item User Session
						\item Update Details Request
					\end{itemize}
				
				\subparagraph{Outcome}
					The user details are changed in the database and are reflected on the user details page.
			
			\paragraph{Condition: User is logged in}
				\subparagraph{Objective}
					To test if the user details can be edited by a user if the user is not logged in.
				
				\subparagraph{Input}
					\begin{itemize}
						\item Bad User Session
						\item Update Details Request
					\end{itemize}
				
				\subparagraph{Outcome}
					The user details are not changed in the database.
	
	\subsection{Plant Management}
		\subsubsection{Create Plant}
		
		\textbf{Pre-conditions:}
		\begin{itemize}
			\item The user should be logged in
			\item The plant's name should not be null
			\item The plant's type should not be null
			\item The plant's age should not be null
			\item An IoT device should be selected to be associated with the plant
		\end{itemize}
		\textbf{Post-conditions:}
		\begin{itemize}
			\item The plant should be assigned a unique identifier
			\item It should be associated with a particular user
			\item An IoT device ID should be associated with the plant
			\item The plant should be persisted in the database with all the above information
		\end{itemize}
			
		\paragraph{Condition: Authenticated}
		\subparagraph{Objective}
		Test that a plant can be added while the user is authenticated.
		
		\subparagraph{Input}
		\begin{itemize}
			\item Username: "TestUser"
			\item Plant name: "TestPlant"
			\item Plant type: "TestType"
			\item Plant age: 0
			\item Colour: "Red"
		\end{itemize}
		
		\subparagraph{Outcome}
		A plant is created.
		
		\paragraph{Condition: Not Authenticated}
		\subparagraph{Objective}
		Test that a plant cannot be added when the user is not authenticated.
		
		\subparagraph{Input}
		\begin{itemize}
			\item Username: "FakeTestUser"
			\item Plant name: "TestPlant"
			\item Plant type: "TestType"
			\item Plant age: 0
			\item Colour: "Red"
		\end{itemize}
		
		\subparagraph{Outcome}
		A plant is not created.
		
		\subsubsection{Delete Plant}
		
		\textbf{Pre-conditions:}
		\begin{itemize}
			\item The user should be logged in
			\item A particular plant should be selected
			\item The user should be the owner of the plant
		\end{itemize}
		\textbf{Post-conditions:}
		\begin{itemize}
			\item The plant's entry should be removed from the database
			\item Any information related to the plant must also be removed from the relevant tables
		\end{itemize}
		
		\paragraph{Condition: Authenticated}
		\subparagraph{Objective}
		Test that a plant can be deleted while the user is authenticated.
		
		\subparagraph{Input}
		\begin{itemize}
			\item Username: "TestUser"
			\item Plant ID: 1
		\end{itemize}
		
		\subparagraph{Outcome}
		The plant is deleted.
		
		\paragraph{Condition: Not Authenticated}
		\subparagraph{Objective}
		Test that a plant cannot be deleted when the user is not authenticated.
		
		\subparagraph{Input}
		\begin{itemize}
			\item Username: "TestFakeUser"
			\item Plant ID: 1
		\end{itemize}
		
		\subparagraph{Outcome}
		A plant is not deleted.
		
		\subsubsection{List Plants}
		
		\textbf{Pre-conditions:}
		\begin{itemize}
			\item The user should be logged in
			\item Username must not be null
		\end{itemize}
		\textbf{Post-conditions:}
		\begin{itemize}
			\item A count of the plants belonging to the supplied username should be returned
			\item A limit to the amount of plants returnable should be provided
			\item A response object containing a list of all plants associated with a user and all their individual details should be returned
		\end{itemize}
		
		\paragraph{Condition: Authenticated}
		\subparagraph{Objective}
		Test that a list of plants can be retrieved when the user is authenticated.
		\subparagraph{Input}
		\begin{itemize}
			\item Username: "TestUser"
		\end{itemize}
		
		\subparagraph{Outcome}
		A list of plants belonging to the user is returned.
		
		\paragraph{Condition: Not Authenticated}
		\subparagraph{Objective}
		Test that a list of plants cannot be retrieved when the user is not authenticated.
		\subparagraph{Input}
		\begin{itemize}
			\item Username: "TestFakeUser"
		\end{itemize}
		
		\subparagraph{Outcome}
		A plant list is not returned.
		
		\subsubsection{View Plant}
		
		\textbf{Pre-conditions:}
		\begin{itemize}
			\item The user should be logged in
			\item A valid plantId should be supplied
		\end{itemize}
		\textbf{Post-conditions:}
		\begin{itemize}
			\item All details associated with a particular plant and gathered by the associated IoT device should be displayed. These details could include:
			\begin{itemize}
				\item Temperature
				\item Humidity
				\item Light conditions
				\item Water flow
				\item Soil moisture
			\end{itemize}
		\end{itemize}
		
		\paragraph{Condition: Authenticated}
		\subparagraph{Objective}
		Test that plant details can be retrieved when the user is authenticated.
		\subparagraph{Input}
		\begin{itemize}
			\item Username: "TestUser"
			\item PlantId: 1
		\end{itemize}
		
		\subparagraph{Outcome}
		The plant details belonging to the specified ID and user are returned.
		
		\paragraph{Condition: Not Authenticated}
		\subparagraph{Objective}
		Test that plant details cannot be retrieved when the user is not authenticated.
		\subparagraph{Input}
		\begin{itemize}
			\item Username: "TestFakeUser"
			\item PlantId: 1
		\end{itemize}
		
		\subparagraph{Outcome}
		The plant details are not returned.
	
		\subsubsection{Update Plant}
		\textbf{Pre-conditions:}
		\begin{itemize}
			\item The user should be logged in
			\item The plant ID must not be null
			\item The relevant updated information must be supplied
			\item The plant must exist
		\end{itemize}
		\textbf{Post-conditions:}
		\begin{itemize}
			\item The plant associated with the supplied plant ID must have its details updated in the database
			\item A response object indicating the operation was successful must be sent back to the client
		\end{itemize}
		
		\paragraph{Condition: Authenticated}
		\subparagraph{Objective}
		Test that a plant can be updated when a user is authenticated.
		\subparagraph{Input}
		\begin{itemize}
			\item Username: "TestUser"
			\item PlantId: 1
			\item Plant name: "TestPlantUpdated"
			\item Plant type: "TestTypeUpdated"
			\item Plant age: 1
			\item Colour: "Pink"
		\end{itemize}
		
		\subparagraph{Outcome}
		The plant details belonging to the specified ID and user are updated.
		
	\paragraph{Condition: Authenticated}
	\subparagraph{Objective}
	Test that a plant cannot be updated when a user is not authenticated.
	\subparagraph{Input}
	\begin{itemize}
		\item Username: "TestFakeUser"
		\item PlantId: 1
		\item Plant name: "TestPlantUpdated"
		\item Plant type: "TestTypeUpdated"
		\item Plant age: 1
		\item Colour: "Pink"
	\end{itemize}
	
	\subparagraph{Outcome}
	The plant details belonging are not updated.
		
	\subsubsection{Configure Lights}
	\textbf{Pre-conditions:}
	\begin{itemize}
		\item The user should be logged in
		\item A particular plant should be selected
		\item An RGB value should be specified
	\end{itemize}
	\textbf{Post-conditions:}
	\begin{itemize}
		\item The RGB value should be communicated to the device
		\item The IoT device should subsequently reflect this RGB colour in the wavelengths of the LED strip, if the RGB value was (0, 0, 0) the lights should be turned off
		\item A response object indicating whether the action was successful should be returned
	\end{itemize}
	
	\paragraph{Condition: Authenticated}
	\subparagraph{Objective}
	Test that the lights can be updated when a user is authenticated.
	\subparagraph{Input}
	\begin{itemize}
		\item Username: "TestUser"
		\item PlantId: 1
		\item RGB value: (255, 0, 0)
	\end{itemize}
	
	\subparagraph{Outcome}
	The desired state is updated to reflect the new light configuration.
	
	\paragraph{Condition: Not Authenticated}
	\subparagraph{Objective}
	Test that the lights cannot be updated when a user is not authenticated.
	\subparagraph{Input}
	\begin{itemize}
		\item Username: "TestFakeUser"
		\item PlantId: 1
		\item RGB value: (255, 0, 0)
	\end{itemize}
	
	\subparagraph{Outcome}
	The desired state is not updated.
	
	\subsubsection{Configure Pump}
	\textbf{Pre-conditions:}
	\begin{itemize}
		\item The user should be logged in
		\item A particular plant should be selected
		\item The configuration details should be specified
	\end{itemize}
	\textbf{Post-conditions:}
	\begin{itemize}
		\item The configuration should be communicated to and applied on the IoT device, the pump should run for the specified amount of time
		\item If the pumpTime value was 0 the pump should turn itself off
		\item A response object indicating whether the action was successful should be returned
	\end{itemize}
	
	\paragraph{Condition: Authenticated}
	\subparagraph{Objective}
	Test that the pump can be updated when a user is authenticated.
	\subparagraph{Input}
	\begin{itemize}
		\item Username: "TestUser"
		\item PlantId: 1
		\item pumpTime: 5
	\end{itemize}
	
	\subparagraph{Outcome}
	The desired state is updated to reflect the new pump configuration.
	
	\paragraph{Condition: Not Authenticated}
	\subparagraph{Objective}
	Test that the pump cannot be updated when a user is not authenticated.
	\subparagraph{Input}
	\begin{itemize}
		\item Username: "TestFakeUser"
		\item PlantId: 1
		\item pumpTime: 5
	\end{itemize}
	
	\subparagraph{Outcome}
	The desired state is not updated.
	
	\subsubsection{Configure Fan}
	\textbf{Pre-conditions:}
	\begin{itemize}
		\item The user should be logged in
		\item A particular plant should be selected
		\item The configuration details should be specified
	\end{itemize}
	\textbf{Post-conditions:}
	\begin{itemize}
		\item The configuration details should be communicated to and applied on the IoT device
		\item A response object indicating whether the action was successful should be returned
	\end{itemize}
	
	\paragraph{Condition: Authenticated}
	\subparagraph{Objective}
	Test that the fan can be updated when a user is authenticated.
	\subparagraph{Input}
	\begin{itemize}
		\item Username: "TestUser"
		\item PlantId: 1
		\item fanSpeed: 10
	\end{itemize}
	
	\subparagraph{Outcome}
	The desired state is updated to reflect the new fan configuration.
	
	\paragraph{Condition: Not Authenticated}
	\subparagraph{Objective}
	Test that the fan cannot be updated when a user is not authenticated.
	\subparagraph{Input}
	\begin{itemize}
		\item Username: "TestFakeUser"
		\item PlantId: 1
		\item fanSpeed: 10
	\end{itemize}
	
	\subparagraph{Outcome}
	The desired state is not updated.
	
	\subsection{Front End}
		\subsubsection{Test Plan}
		The focus of front-end tests will be to ensure that all AngularJS components integrate correctly with their dependant components, as well as with the Java backend (which in turn will communicate with the AWS services). \href{http://www.protractortest.org/#/}{Protractor} will be used for end-to-end (e2e) integration tests, and \href{https://karma-runner.github.io/1.0/index.html}{Karma} will be used for unit testing each Angular component. Integration tests form the backbone of any frontend system and will be as extensive and complete as possible. User scenarios will be simulated and run via Protractor to test all possible user interaction. Unit tests will be run on all critical frontend components.
		
		Test creation will form part of the daily design and implementation workflow. It is not a separate "phase" - as soon as new functionality is added or changed, accompanying tests should be created and executed. If a bug or error is detected outside of testing, the error or bug will be immediately fixed and an accompanying test will be added. Test automation will be implemented to ensure that all tests are executed every time a new commit is made. 
			
		\subsubsection{Test Scenarios}
			\paragraph{Unit Testing}
				\textit{Unit tests will only be written for critical frontend components if the need arises}
			\paragraph{Integration (end-to-end) Testing}
				Basic application necessities:			
				\begin{itemize}
					\item Application should have a title
					\item Application should not allow a user unauthorised access to the site
				\end{itemize}
				Landing Page:
				\begin{itemize}
				 \item \textit{Pre-conditions:} 
					\begin{itemize}
						\item User accesses web application via frontend
						\item User is not logged in
					\end{itemize}
				\end{itemize}
				\begin{itemize}
					\item Login
					
					\begin{itemize}
						\item \textit{Pre-conditions:}
						\begin{itemize}
							\item User must not be logged in
							\item User must already have an account
						\end{itemize}
						\item \textit{Post-conditions:}
						\begin{itemize}
							\item User must be logged in
						\end{itemize}						 
						\item User should be able to switch to registration form if they do not have an account
						\item User should be able to log in if they have entered the correct credentials and be redirected to the main site dashboard
						\item User should not be logged in if they enter no credentials or the incorrect credentials and an appropriate error message should be displayed
						
					\end{itemize}
					
					\item Registration
					\begin{itemize}
						\item \textit{Pre-conditions:}
						\begin{itemize}
							\item User must not be logged in
							\item User must have navigated to the registration form
							\item User must not have an account
							\item User's email or username must not already be in use
						\end{itemize}
						\item \textit{Post-conditions:}
						\begin{itemize}
							\item User must have an account registered on the system backend
							\item User must be logged in
						\end{itemize}
						\item User should be able to switch to the login form if they already have an account
						\item User should have their details saved in the backend and be automatically logged in if they have entered all their details and their details are not already on the system
						\item User should not have their details registered if they do not enter all the required information or if their username or email is already on the system
					\end{itemize}				 
				\end{itemize}
				Main site:
				\begin{itemize}
					\item Navbar
					\begin{itemize}
						\item \textit{Pre-conditions:}
							\begin{itemize}
								\item User must be logged in
							\end{itemize}
						\item If the user clicks "Logout", the user's credentials are immediately discarded and the user is redirected back to the landing page. \textit{Postcondition: The user is logged out and cannot access the site anymore}
					\end{itemize}
				\end{itemize}
	
	\subsection{Device Communications}
	\subsubsection{Test Plan}
	In order to fully test the IoT back end component of the project, we need to ensure that a number of connections are in place and are working as expected:
	\begin{itemize}
		\item{From the device to IoT}
		\item{From IoT to Lambda}
		\item{From Lambda to DynamoDB}
		\\
		\item{From API Gateway to Lambda}
		\item{From Lambda to the device's shadow via IoT}
		\item{From the shadow to the device}
	\end{itemize}
	
	These connections are made up of the device (Arduino), IoT, Lambda and the API Gateway. Each of these parts must be tested individually and then together as a whole. This will be laid out in the sections below.
	
	Currently, there is no automated processes to test the use cases below, and the testing has to be done manually. The test are performed whenever a change is made to the respective subsystem, so the testing is done during development and not on a separate schedule. Later on in development, the tests will be automated.
	\subsubsection{Scope}
	The scope of this section of the testing encompasses the above mentioned parts and how they interoperate. This includes the following subsystems and use-cases:
	\begin{itemize}
		\item Device Communications
		\begin{itemize}
			\item Update Thing Shadow
			\item Update Web Interface
		\end{itemize}
	\end{itemize}
	
	\subsubsection{Testing Strategy}
	\paragraph{Unit Testing}
	\subparagraph{Device Mocking:}
	In order to test the functionality of the device, we have created a mock device using the AWS IoT Device SDK for JavaScript, and have coded the mock device using NodeJS. The mock device is not currently handled by a testing environment and has to be managed manually via the terminal. The mock device makes use of npm to retrieve the AWS IoT Device SDK for JavaScript so that the mock device can connect to IoT.
	\begin{itemize}
		\item Pre-conditions:
		\begin{itemize}
			\item The device should have the correct certificates created and linked
			\item A corresponding thing should have been created on IoT for the device
		\end{itemize}
		\item The device should connect
		\item The device should send an update message
		\item The device should listen for a response
		\item The device should retrieve any shadow updates from IoT
		\item Post-conditions:
		\begin{itemize}
			\item The device should have connected successfully
			\item The package should have been delivered 
			\item Any shadow updates should have been applied ot the device
		\end{itemize}
	\end{itemize}
	
	\subparagraph{IoT rule test:}
	When the mock device test is run, it will send an MQTT message to the IoT platform. From here, we can check whether the device shadow has been updated and if the rule has been triggered. If the shadow is updated, then the connection was successful. If the connection was successful but the rule was not triggered, then the rule is not working. We still need to automate this process. Because IoT is on the AWS servers, there is not (so far as we are aware) any testing framework that can trigger and test this use case, and the test has to be performed manually.
	\begin{itemize}
		\item Pre-conditions:
		\begin{itemize}
			\item A test thing must have been created
			\item An IoT rule that corresponds to the test thing must have been created
		\end{itemize}
		\item An MQTT message should be sent on the corresponding topic to the rule.
		\item The rule should react to the topic
		\item Post-conditions:
		\begin{itemize}
			\item The rule has been executed
		\end{itemize}
	\end{itemize}
	
	\subparagraph{Lambda Function Test:}
	The AWS Lambda console has testing integrated into the platform. We have written a test package to send to Lambda that simulates the messages sent from an IoT device through an IoT rule. The test runs a mock DynamoDB database and will return if the test was successful or not. We can also use the logging feature to check the test results. We still need to automate this process.
	\begin{itemize}
		\item Pre-conditions:
		\begin{itemize}
			\item The Lambda function has been created
			\item A test case has been written and stored in the integrated testing component of AWS Lambda
		\end{itemize}
		\item The test case is run using the AWS Lambda testing interface on the Lambda console
		\item Post-conditions:
		\begin{itemize}
			\item The Lambda function should have run
		\end{itemize}
	\end{itemize}
	
	\subparagraph{API Gateway and Thing Shadows:}
	Because we have not yet implemented the thing shadow interface and functionality, there is no testing for the API Gateway connection or thing shadow yet.
	
	\paragraph{System and Integration Testing}
	\begin{itemize}
		\item{Communication between a device and IoT}
		\begin{itemize}
			\item Pre-conditions: 
			\begin{itemize}
				\item A device exists and is connected to the internet
				\item A thing has been created that relates to the device
				\item The device has the correct credentials
				\item There is an IoT rule subscribed to the topic related for the thing
			\end{itemize}
			\item The device should be able to send a message to IoT
			\item IoT should be able to pick up the message and fire a rule
			\item IoT should be able to change the shadow of the thing
			\item The thing shadow should update the device
			\item Post-conditions:
			\begin{itemize}
				\item An IoT rule has been fired by the device
				\item The thing shadow has been updated
				\item The device is synchronised with the thing shadow
			\end{itemize}
		\end{itemize}
		\item{Communication between IoT and Lambda}
		\begin{itemize}
			\item Pre-conditions: 
			\begin{itemize}
				\item There is an IoT rule that triggers a Lambda function
				\item The Lambda function that is to be triggered exists
			\end{itemize}
			\item An IoT rule should be able to be triggered
			\item The rule should be able to trigger a Lambda function
			\item The data from the rule should be sent to the Lambda function 
			\item The Lambda function should receive the data from the rule
			\item The Lambda function should execute correctly
			\item Post-conditions:
			\begin{itemize}
				\item An IoT rule triggers a Lambda function
				\item Data is sent from an IoT rule to a Lambda function
				\item A Lambda function retrieves data from an IoT rule
			\end{itemize}
		\end{itemize}
		
		\item{Communication between Lambda and DynamoDB}
		\begin{itemize}
			\item Pre-conditions: 
			\begin{itemize}
				\item There is a Lambda function that uses DynamoDB
			\end{itemize}
			\item A Lambda function is triggered
			\item The Lambda function saves an item in a DynamoDB table
			\item The Lambda function correctly retrieves a saved item
			\item Post-conditions:
			\begin{itemize}
				\item An item is saved in a DynamoDB table from a Lambda function
				\item An item is retrieved by a Lambda function from DynamoDB
			\end{itemize}
		\end{itemize}
	\end{itemize}

	\subsection{Usability}

\section{Test Deliverables}
	Through the implementation of this testing plan, the following artefacts are generated:
	\begin{itemize}
		\item Test Plan
		\item Test Report
		\item Maven Testing Logs
	\end{itemize}
	
\section{Unit Test Report}
	\subsection{Detailed Test Results}
		\subsubsection{Overview of Test Results}
		\subsubsection{Functional Requirements Test Results}
			For each of the functional requirements test cases, the following results (along with the reasons for the results) were generated:
			
			\paragraph{Persist to Database (TC 3.1.1)}
				\begin{enumerate}
					\item The correct key fields and unique keys added a new record in the correct table
					\item The correct key fields but non-unique keys failed to add a new record in the table
					\item Incorrect key fields failed to add a new record in the table
				\end{enumerate}
				\subparagraph{Result: } Pass
			
			\paragraph{Query Database (TC 3.1.2)}
				\begin{enumerate}
					\item An authorised role is able to query the database and retrieve a record
					\item An unauthorised role is unable to query the database
				\end{enumerate}
			
				\subparagraph{Result: } Pass
			
			\paragraph{Remove from Database (TC 3.1.3)}
				\begin{enumerate}
					\item An authorised role is able to delete a record from the database
					\item An unauthorised role is unable to delete a record from the database
				\end{enumerate}
				\subparagraph{Result: } Pass
			
			\paragraph{Register User (TC 3.2.1)}
				\begin{enumerate}
					\item A new user is registered and logged in when the user provides a unique email address and user name
					\item A new user is not registered when the user provides a non-unique email address or user name
				\end{enumerate}
				\subparagraph{Result: } Pass
			
			\paragraph{Login (TC 3.2.2)}
				\begin{enumerate}
					\item A user is logged in when they provide the correct login details
					\item A user is not logged in when they provide incorrect login details and cannot access any page except the login and register pages
				\end{enumerate}
				\subparagraph{Result: } Pass
			
			\paragraph{Logout (TC 3.2.3)}
				\begin{enumerate}
					\item A logged in user is logged out and their session is terminated, allowing them to only access the login and register pages until they log in again
				\end{enumerate}
				\subparagraph{Result: } Pass
			
			\paragraph{Update User (TC 3.2.4)}
				\begin{enumerate}
					\item The user details are updated and persisted in the database when that user is logged in
					\item The user details are not updated if that user is not logged in
				\end{enumerate}
				\subparagraph{Result: } Pass
			
			\paragraph{Create Plant (TC 3.3.1)}
				\begin{enumerate}
					\item 
				\end{enumerate}
				\subparagraph{Result: } Pass
				
			\paragraph{Delete Plant (TC 3.3.2)}
				\begin{enumerate}
					\item 
				\end{enumerate}
				\subparagraph{Result: } Pass
				
			\paragraph{List Plants (TC 3.3.3)}
				\begin{enumerate}
					\item 
				\end{enumerate}
				\subparagraph{Result: } Pass
				
			\paragraph{View Plant (TC 3.3.4)}
				\begin{enumerate}
					\item 
				\end{enumerate}
				\subparagraph{Result: } Pass
				
			\paragraph{Update Plant (TC 3.3.5)}
				\begin{enumerate}
					\item 
				\end{enumerate}
				\subparagraph{Result: } Pass
				
			\paragraph{Configure Lights (TC 3.3.6)}
				\begin{enumerate}
					\item 
				\end{enumerate}
				\subparagraph{Result: } Pass
				
			\paragraph{Configure Pump (TC 3.3.7)}
				\begin{enumerate}
					\item 
				\end{enumerate}
				\subparagraph{Result: } Pass
				
			\paragraph{Configure Fan (TC 3.3.8)}
				\begin{enumerate}
					\item 
				\end{enumerate}
				\subparagraph{Result: } Pass
			
		\subsubsection{Non-Functional Requirements Test Results}
			\paragraph{Test Case 1}
				\begin{enumerate}
					\item 
				\end{enumerate}
				\subparagraph{Result: } Pass
	\subsection{Other}
		\subsubsection{Build Log}
		The following build log was generated by Travis CI that shows the Maven build and testing process.
		\begin{figure}[H]
			\includegraphics[width=\linewidth]{images/travis1}
			\caption{The initial configuration and downloading of dependencies}
		\end{figure}
		\begin{figure}[H]
			\includegraphics[width=\linewidth]{images/travis2}
			\caption{The running of tests}
		\end{figure}
	\subsection{Conclusion and Recommendations}


\end{document}